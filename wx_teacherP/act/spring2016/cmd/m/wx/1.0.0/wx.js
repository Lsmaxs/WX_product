define(function(require,exports,module){var a=require("zepto"),b=require("http://res.wx.qq.com/open/js/jweixin-1.0.0.js"),c=require("qt/sha");function d(){var a=window.location.hostname;return 0==a.indexOf("dev.")?!0:0==a.indexOf("local.")?!0:0==a.indexOf("127.")?!0:!1}var e=d(),f="http://"+(e?"dev.myhost-domain.cn":"www.myhost-domain.cn")+"/jxhd/wap/common/getJjTicket",g=location.href.replace(/\#.*$/,"");function h(){return Math.random().toString(36).substr(2,15)}function i(){return parseInt((new Date).getTime()/1e3)+""}function j(a){var b=Object.keys(a);b=b.sort();var c={};b.forEach(function(b){c[b.toLowerCase()]=a[b]});var d="";for(var e in c)d+="&"+e+"="+c[e];return d=d.substr(1)}function k(a,b){var d={jsapi_ticket:a,nonceStr:h(),timestamp:i(),url:b},e=j(d);return d.signature=c.sha1(e),d}b.getJsTicket=function(c){var d={schoolCode:c.schoolCode?c.schoolCode:"",cropId:c.cropId?c.cropId:""};a.ajax({url:f,data:d,dataType:"jsonp",success:function(a){if("001"==a.resultCode){var d=a.cropId,e=a.ticket,f=k(e,g);b.config({debug:!1,appId:d,timestamp:f.timestamp,nonceStr:f.nonceStr,signature:f.signature,jsApiList:c.jsApiList}),b.ready(function(){c.ready&&c.ready()}),b.error(function(a){c.error&&c.error(a)})}}})},module.exports=b});