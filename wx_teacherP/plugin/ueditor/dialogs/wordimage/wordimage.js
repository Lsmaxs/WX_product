var wordImage={},g=baidu.g,flashObj,flashContainer;wordImage.init=function(a,b){showLocalPath("localPath"),createFlashUploader(a,b),addUploadListener(),addOkListener()};function hideFlash(){flashObj=null,flashContainer.innerHTML=""}function addOkListener(){dialog.onok=function(){if(imageUrls.length){var a=editor.getOpt("imageUrlPrefix"),b=domUtils.getElementsByTagName(editor.document,"img");editor.fireEvent("saveScene");for(var c,d=0;c=b[d++];){var e=c.getAttribute("word_img");if(e)for(var f,g=0;f=imageUrls[g++];)if(-1!=e.indexOf(f.original.replace(" ",""))){c.src=a+f.url,c.setAttribute("_src",a+f.url),c.setAttribute("title",f.title),domUtils.removeAttributes(c,["word_img","style","width","height"]),editor.fireEvent("selectionchange");break}}editor.fireEvent("saveScene"),hideFlash()}},dialog.oncancel=function(){hideFlash()}}function addUploadListener(){g("upload").onclick=function(){flashObj.upload(),this.style.display="none"}}function showLocalPath(a){var b=editor.selection.getRange().getClosedNode(),c=editor.execCommand("wordimage");if(1==c.length||b&&"IMG"==b.tagName)return void(g(a).value=c[0]);var d=c[0],e=d.lastIndexOf("/")||0,f=d.lastIndexOf("\\")||0,h=e>f?"/":"\\";d=d.substring(0,d.lastIndexOf(h)+1),g(a).value=d}function createFlashUploader(a,b){var c=utils.extend({},lang.flashI18n);for(var d in c)d in{lang:1,uploadingTF:1,imageTF:1,textEncoding:1}||!c[d]||(c[d]=encodeURIComponent(editor.options.langPath+editor.options.lang+"/images/"+c[d]));a=utils.extend(a,c,!1);var e={createOptions:{id:"flash",url:a.flashUrl,width:a.width,height:a.height,errorMessage:lang.flashError,wmode:browser.safari?"transparent":"window",ver:"10.0.0",vars:a,container:a.container}};e=extendProperty(b,e),flashObj=new baidu.flash.imageUploader(e),flashContainer=$G(a.container)}function extendProperty(a,b){for(var c in a)b[c]||(b[c]=a[c]);return b}function getPasteData(a){return baidu.g("msg").innerHTML=lang.copySuccess+"</br>",setTimeout(function(){baidu.g("msg").innerHTML=""},5e3),baidu.g(a).value}function createCopyButton(a,b){baidu.swf.create({id:"copyFlash",url:"fClipboard_ueditor.swf",width:"58",height:"25",errorMessage:"",bgColor:"#CBCBCB",wmode:"transparent",ver:"10.0.0",vars:{tid:b}},a);var c=baidu.swf.getMovie("copyFlash"),d=setInterval(function(){c&&c.flashInit&&(clearInterval(d),c.setHandCursor(!0),c.setContentFuncName("getPasteData"))},500)}createCopyButton("clipboard","localPath");