!function(a,b){var c,d,e,f=a.Chart,g=a.extend,h=a.each;e=["path","rect","circle"],d={top:0,left:0,center:.5,middle:.5,bottom:1,right:1};var i=b.inArray,j=a.merge;function k(a){var b,c;return c={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}},b={circle:{params:{x:0,y:0}}},b[a]&&(c.shape=j(c.shape,b[a])),c}function l(a){return"[object Array]"===Object.prototype.toString.call(a)}function m(a){return"number"==typeof a}function n(a){return a!==c&&null!==a}function o(a,b,c,d,e){for(var f=a.length,g=0;f>g;)"number"==typeof a[g]&&"number"==typeof a[g+1]?(a[g]=b.toPixels(a[g])-d,a[g+1]=c.toPixels(a[g+1])-e,g+=2):g+=1;return a}var p=function(){this.init.apply(this,arguments)};p.prototype={init:function(a,b){var c=b.shape&&b.shape.type;this.chart=a,this.options=j({},k(c),b)},render:function(a){var b=this,c=this.chart,d=b.chart.renderer,f=b.group,g=b.title,h=b.shape,j=b.options,k=j.title,l=j.shape;f||(f=b.group=d.g()),!h&&l&&-1!==i(l.type,e)&&(h=b.shape=d[j.shape.type](l.params),h.add(f)),!g&&k&&(g=b.title=d.label(k),g.add(f)),f.add(c.annotations.group),b.linkObjects(),a!==!1&&b.redraw()},redraw:function(){var b,c,e,f,h,j,k,l=this.options,p=this.chart,q=this.group,r=this.title,s=this.shape,t=this.linkedObject,u=p.xAxis[l.xAxis],v=p.yAxis[l.yAxis],w=l.width,x=l.height,y=d[l.anchorY],z=d[l.anchorX],A=!1;if(t&&(c=t instanceof a.Point?"point":t instanceof a.Series?"series":null,"point"===c?(l.xValue=t.x,l.yValue=t.y,e=t.series):"series"===c&&(e=t),q.visibility!==e.group.visibility&&q.attr({visibility:e.group.visibility})),j=n(l.xValue)?u.toPixels(l.xValue+u.minPointOffset)-u.minPixelPadding:l.x,k=n(l.yValue)?v.toPixels(l.yValue):l.y,!isNaN(j)&&!isNaN(k)&&m(j)&&m(k)){if(r&&(r.attr(l.title),r.css(l.title.style),A=!0),s){if(b=g({},l.shape.params),"values"===l.units){for(f in b)i(f,["width","x"])>-1?b[f]=u.translate(b[f]):i(f,["height","y"])>-1&&(b[f]=v.translate(b[f]));b.width&&(b.width-=u.toPixels(0)-u.left),b.x&&(b.x+=u.minPixelPadding),"path"===l.shape.type&&o(b.d,u,v,j,k)}"circle"===l.shape.type&&(b.x+=b.r,b.y+=b.r),A=!0,s.attr(b)}q.bBox=null,m(w)||(h=q.getBBox(),w=h.width),m(x)||(h||(h=q.getBBox()),x=h.height),m(z)||(z=d.center),m(y)||(y=d.center),j-=w*z,k-=x*y,p.animation&&n(q.translateX)&&n(q.translateY)?q.animate({translateX:j,translateY:k}):q.translate(j,k)}},destroy:function(){var a=this,b=this.chart,c=b.annotations.allItems,d=c.indexOf(a);d>-1&&c.splice(d,1),h(["title","shape","group"],function(b){a[b]&&(a[b].destroy(),a[b]=null)}),a.group=a.title=a.shape=a.chart=a.options=null},update:function(a,b){g(this.options,a),this.linkObjects(),this.render(b)},linkObjects:function(){var a=this,b=a.chart,c=a.linkedObject,d=c&&(c.id||c.options.id),e=a.options,f=e.linkedTo;n(f)?n(c)&&f===d||(a.linkedObject=b.get(f)):a.linkedObject=null}},g(f.prototype,{annotations:{add:function(a,b){var c,d,e=this.allItems,f=this.chart;for(l(a)||(a=[a]),d=a.length;d--;)c=new p(f,a[d]),e.push(c),c.render(b)},redraw:function(){h(this.allItems,function(a){a.redraw()})}}}),f.prototype.callbacks.push(function(b){var c,d=b.options.annotations;c=b.renderer.g("annotations"),c.attr({zIndex:7}),c.add(),b.annotations.allItems=[],b.annotations.chart=b,b.annotations.group=c,l(d)&&d.length>0&&b.annotations.add(b.options.annotations),a.addEvent(b,"redraw",function(){b.annotations.redraw()})})}(Highcharts,HighchartsAdapter);