!function(a){var b=a.getOptions().plotOptions,c=a.seriesTypes,d=a.merge,e=function(){},f=a.each;b.funnel=d(b.pie,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:!0,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}}}),c.funnel=a.extendClass(c.pie,{type:"funnel",animate:e,translate:function(){var a,b,c,d,g,h,i,j,k,l,m,n=function(a,b){return/%$/.test(a)?b*parseInt(a,10)/100:parseInt(a,10)},o=0,p=this.chart,q=p.plotWidth,p=p.plotHeight,r=0,s=this.options,t=s.center,u=n(t[0],q),v=n(t[0],p),w=n(s.width,q),x=n(s.height,p),y=n(s.neckWidth,q),z=n(s.neckHeight,p),A=x-z,n=this.data,B="left"===s.dataLabels.position?1:0;this.getWidthAt=b=function(a){return a>x-z||x===z?y:y+(w-y)*((x-z-a)/(x-z))},this.getX=function(a,c){return u+(c?-1:1)*(b(a)/2+s.dataLabels.distance)},this.center=[u,v,x],this.centerX=u,f(n,function(a){o+=a.y}),f(n,function(f){m=null,d=o?f.y/o:0,h=v-x/2+r*x,k=h+d*x,a=b(h),g=u-a/2,i=g+a,a=b(k),j=u-a/2,l=j+a,h>A?(g=j=u-y/2,i=l=u+y/2):k>A&&(m=k,a=b(A),j=u-a/2,l=j+a,k=A),c=["M",g,h,"L",i,h,l,k],m&&c.push(l,m,j,m),c.push(j,k,"Z"),f.shapeType="path",f.shapeArgs={d:c},f.percentage=100*d,f.plotX=u,f.plotY=(h+(m||k))/2,f.tooltipPos=[u,f.plotY],f.slice=e,f.half=B,r+=d}),this.setTooltipPoints()},drawPoints:function(){var a=this,b=a.options,c=a.chart.renderer;f(a.data,function(d){var e=d.graphic,f=d.shapeArgs;e?e.animate(f):d.graphic=c.path(f).attr({fill:d.color,stroke:b.borderColor,"stroke-width":b.borderWidth}).add(a.group)})},sortByAngle:e,drawDataLabels:function(){var a,b,d,e,f,g=this.data,h=this.options.dataLabels.distance,i=g.length;for(this.center[2]-=2*h;i--;)d=g[i],b=(a=d.half)?1:-1,f=d.plotY,e=this.getX(f,a),d.labelPos=[0,f,e+(h-5)*b,f,e+h*b,f,a?"right":"left",0];c.pie.prototype.drawDataLabels.call(this)}})}(Highcharts);